(()=>{"use strict";class e{applyInjectedCss(e){let t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.head.appendChild(t)}populatePlayerList(e,t){t.logData("Starting to populate selection menu");const n=t.HTMLNodes.playerSelectList;n.innerHTML="",e.length>0?(t.logData("Starting to populate selection menu"),e.forEach((e=>{t.logData(`Adding option for player: ${e.displayName}, ID: ${e.playerId}`);let i=document.createElement("li");i.classList.add("dropdown_item"),i.innerText=e.displayName,i.dataset.playerId=e.playerId,i.addEventListener("click",(()=>{t.HTMLNodes.playerSelectDropdown.innerText=e.displayName,t.HTMLNodes.selectedPlayerTitle.innerText="Interacting with player: "+e.displayName,n.classList.add("hide"),t.selectedPlayer=e.playerId,t.logData(t.selectedPlayer),t.logData(`Selected player: ${e.displayName} (ID: ${e.playerId})`)})),n.appendChild(i)})),n.classList.toggle("hide"),t.logData(t.HTMLNodes.playerSelectList.innerHTML)):t.logData("No players found in the list.")}outputCSSRules(e,t){}dumpScriptContentByName(e,t,n){let i="";n._logToDebugPanel(`Dumping content for script: ${t}\n`);const o=document.querySelectorAll("script");n._logToDebugPanel(`Number of script tags found: ${o.length}\n`);const s=Array.from(o).find((e=>e.src===t));if(s)n._logToDebugPanel(`Target script found: ${s.src}\n`),fetch(s.src).then((e=>(e.ok||n._logToDebugPanel(`Network response was not ok: ${e.statusText}`),e.text()))).then((e=>{i+=`/* ${s.src} */\n\n${e}\n\n`,n._logToDebugPanel("Content fetched successfully.\n"),n._logToDebugPanel(i)})).catch((e=>{n._logToDebugPanel(`Error fetching script content: ${e.message}\n`)}));else{n._logToDebugPanel("Script not found or is an inline script.\n"),n._logToDebugPanel("Searching for inline scripts...\n");const e=Array.from(o).find((e=>e.textContent.includes(t)));e?(n._logToDebugPanel("Inline script found. Displaying content...\n"),i+=`/* Inline script */\n\n${e.textContent}\n\n`,n._logToDebugPanel(i)):n._logToDebugPanel("Inline script not found.\n")}}}class t{disownConstruct(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2004,[],JSON.stringify({id:e}))}takeOverConstruct(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2008,[],JSON.stringify({id:e}))}repairConstruct(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2009,[],JSON.stringify({id:e}))}removeDRMproctection(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2010,[],JSON.stringify({id:e}))}repairElement(e,t){!1!==e&&(this.logData(e+","+t),CPPMod.sendModAction("AkimboAdmin",2005,[],JSON.stringify({id:e,constructId:t})))}BypassDispenser(e,t){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2006,[],JSON.stringify({id:e,constructId:t}))}ResetDispenser(e,t){!1!==e&&CPPMod.sendModAction("AkimboAdmin",2007,[],JSON.stringify({id:e,constructId:t}))}configureTeleporter(e,t,n,i){this.logData(e+" "+t+" "+n+" "+i),!1!==n&&CPPMod.sendModAction("AkimboAdmin",2012,[],JSON.stringify({id:e,constructId:t,teleportName:n,type:i}))}addTeleportDestination(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3001,[],JSON.stringify({teleportName:e}))}ClaimOwnedTerritory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3002,[],JSON.stringify({tag:e}))}ClaimUnownedTerritory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3003,[],JSON.stringify({tag:e}))}searchForPlayer(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3004,[],JSON.stringify({name:e}))}teleportToPlayer(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3005,[],JSON.stringify({id:e}))}teleportPlayerHere(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3006,[],JSON.stringify({id:e}))}teleportToCoordinates(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3007,[],JSON.stringify({pos:e}))}teleportPlayerToCoordinates(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3008,[],JSON.stringify({pos:e}))}sendTeleportLocation(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3009,[],JSON.stringify({tag:e}))}fillInventory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3010,[],JSON.stringify({id:e}))}fillPlayerInventory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3011,[],JSON.stringify({id:e}))}clearInventory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3012,[],JSON.stringify({id:e}))}clearPlayerInventory(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3013,[],JSON.stringify({id:e}))}AddItemToInventory(e,t,n){!1!==e&&!1!==t&&CPPMod.sendModAction("AkimboAdmin",3014,[],JSON.stringify({id:e,itemId:t,quantity:n}))}AddItemToPlayerInventory(e,t,n){!1!==e&&!1!==t&&CPPMod.sendModAction("AkimboAdmin",3015,[],JSON.stringify({id:e,itemId:t,quantity:n}))}ImportBlueprint(e,t,n){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3016,[],JSON.stringify({searchstr:e,magicUse:t,selectedPlayer:n||null}))}toggleMagicBlueprint(e,t){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3017,[],JSON.stringify({id:e,free_deploy:t}))}giveBlueprint(e,t){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3018,[],JSON.stringify({id:e,selectedPlayer:t}))}deleteBlueprint(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",3019,[],JSON.stringify({id:e}))}logData(e){!1!==e&&CPPMod.sendModAction("AkimboAdmin",888,[],JSON.stringify({data:e}))}}const n=class{constructor(e,t=[],n="Select an Option"){this.selectBody=this.createElement(e,"div",["custom_select_body"]),this.selectDropdown=this.createElement(this.selectBody,"div",["custom_dropdown"]),this.selectDropdown.innerText=n,this.dropdownList=this.createElement(this.selectBody,"ul",["akimbo_dropdown_list","hide"]),this.populateOptions(t),this.selectDropdown.addEventListener("click",(()=>{this.dropdownList.classList.toggle("hide")}))}populateOptions(e){this.dropdownList.innerHTML="",e.forEach((e=>{const t=this.createElement(this.dropdownList,"li",["dropdown_item"]);t.innerText=e,t.addEventListener("click",(()=>{this.selectDropdown.innerText=e,this.dropdownList.classList.add("hide")}))}))}createElement(e,t,n=[]){const i=document.createElement(t);return n.length&&i.classList.add(...n),e.appendChild(i),i}};class i extends MousePage{constructor(){super(),this.adminFunctions=new e,this.adminModInteraction=new t,this._createHTML(),this.logData=this.adminModInteraction.logData,this.showDispensers=!1,this.showTeleports=!1,this.wrapperNode.classList.add("hide"),engine.on("AkimboAdminElementHud.show",this.showIt,this),engine.on("AkimboAdminElementHud.setElementInfo",this.setElementInfo,this),"undefined"!=typeof injectedCss&&this.adminFunctions.applyInjectedCss(injectedCss)}setElementInfo(e){const t=JSON.parse(e);this.HTMLNodes.ConstructId.innerText="Construct Id: "+t.ConstructId,this.HTMLNodes.ElementId.innerText="Element Id: "+t.Id,this.cInfo=t;const n=!!t.Teleporters;this.HTMLNodes.teleportConfigurationBody.classList.toggle("hide",!n),this.HTMLNodes.teleportButtonBody.classList.toggle("hide",!n),this.badButton.classList.toggle("hide",!t.Dispensers),this.brdButton.classList.toggle("hide",!t.Dispensers),t.Teleporters&&(this.logData("teleporters enabled"),this.HTMLNodes.TPD.populateOptions(t.locations)),t.Dispensers&&this.logData("dispensers enabled"),this.logData(this.cInfo.Id+","+this.cInfo.ConstructId)}showIt(e){e?(hudManager.toggleEnhancedMouse(),this.show(!0)):this.show(!1)}show(e){super.show(e)}_onVisibilityChange(){super._onVisibilityChange(),this.wrapperNode.classList.toggle("hide",!this.isVisible),this.isVisible?inputCaptureManager.captureText(!0,(()=>this._close())):inputCaptureManager.captureText(!1)}_close(){this.show(!1),hudManager.toggleEnhancedMouse()}_createHTML(){this.HTMLNodes={},this.wrapperNode=createElement(document.body,"div",["AkimboAdminConstructHud_panel"]);let e=createElement(this.wrapperNode,"div",["AkimboAdminConstructHud_header"]);this.HTMLNodes.panelTitle=createElement(e,"h5",["panel_title"]),this.HTMLNodes.panelTitle.innerText="Akimbo Element HUD",this.HTMLNodes.closeIconButton=createElement(e,"button",["closeConstructPanel_button"]),this.HTMLNodes.closeIconButton.innerText="Close",this.HTMLNodes.closeIconButton.addEventListener("click",(()=>this._close()));let t=createElement(this.wrapperNode,"div",["ConstructRow-flex-center"]);this.HTMLNodes.ElementId=createElement(t,"h5",["construct-sub-title"]),this.HTMLNodes.ConstructId=createElement(t,"h5",["construct-sub-title"]),this.HTMLNodes.OwnerName=createElement(t,"h5",["construct-sub-title"]);let i=createElement(this.wrapperNode,"div",["row-flex-center"]),o=createElement(i,"button",["dump-button"]);o.innerText="Repair Element",o.addEventListener("click",(()=>{this.adminModInteraction.repairElement(this.cInfo.Id,this.cInfo.ConstructId)})),this.badButton=createElement(i,"button",["dump-button","hide"]),this.badButton.innerText="Bypass dispenser",this.badButton.addEventListener("click",(()=>{this.adminModInteraction.BypassDispenser(this.cInfo.Id,this.cInfo.ConstructId)})),this.brdButton=createElement(i,"button",["dump-button","hide"]),this.brdButton.innerText="Reset dispenser",this.brdButton.addEventListener("click",(()=>{this.adminModInteraction.ResetDispenser(this.cInfo.Id,this.cInfo.ConstructId)})),this.HTMLNodes.teleportConfigurationBody=createElement(this.wrapperNode,"div",["container-full","hide"]),this.HTMLNodes.TPD_Title=createElement(this.HTMLNodes.teleportConfigurationBody,"h5",["panel_title"]),this.HTMLNodes.TPD_Title.innerText="Teleport Configuration",this.HTMLNodes.TPD=new n(this.HTMLNodes.teleportConfigurationBody,[],"Select a TP location"),this.HTMLNodes.teleportButtonBody=createElement(this.wrapperNode,"div",["ConstructRow-flex-center","hide"]),this.TPDButton=createElement(this.HTMLNodes.teleportButtonBody,"button",["dump-button"]),this.TPDButton.innerText="Set as Teleport Destination",this.TPDButton.addEventListener("click",(()=>{var e=this.HTMLNodes.TPD.selectDropdown.innerText;this.logData(e),this.adminModInteraction.configureTeleporter(this.cInfo.Id,this.cInfo.ConstructId,e,"destination")})),this.TPTButton=createElement(this.HTMLNodes.teleportButtonBody,"button",["dump-button"]),this.TPTButton.innerText="Set Target To Teleport",this.TPTButton.addEventListener("click",(()=>{var e=this.HTMLNodes.TPD.selectDropdown.innerText;this.logData(e),this.adminModInteraction.configureTeleporter(this.cInfo.Id,this.cInfo.ConstructId,e,"target")}))}}new i})();